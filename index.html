<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Festive Truth or Dare</title>
    <style>
        :root {
            --truth-color: rgba(253, 251, 247, 0.95); /* Slightly transparent cream */
            --truth-text: #b8860b;
            --dare-color: rgba(139, 0, 0, 0.9); /* Slightly transparent red */
            --dare-text: #ffffff;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            /* Snowy Forest Background Image */
            background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('https://images.unsplash.com/photo-1482686119632-c63880954b3c?q=80&w=2070&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            overflow-x: hidden;
            color: white;
            touch-action: manipulation; 
            -webkit-tap-highlight-color: transparent;
            min-height: 100vh;
        }

        /* --- Layout Structure --- */
        .app-container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            position: relative;
            z-index: 10;
        }

        /* Header with blur effect */
        .top-header-container {
            position: relative;
            background: rgba(15, 44, 31, 0.7); /* Semi-transparent green */
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border-bottom: 1px solid rgba(255, 215, 0, 0.5);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            padding-bottom: 10px;
        }

        /* --- Dotty Snow Animation (Whole Page) --- */
        .snow-container {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .snowflake {
            position: absolute;
            background-color: white;
            border-radius: 50%; /* Makes them dots */
            opacity: 0.8;
            top: -10px;
            animation: fall linear infinite;
        }

        @keyframes fall {
            0% { transform: translateY(-10px) translateX(0); opacity: 0.8; }
            100% { transform: translateY(110vh) translateX(20px); opacity: 0.4; }
        }

        /* --- Settings Panel --- */
        .settings-panel {
            padding: 15px 10px;
            text-align: center;
            position: relative;
            z-index: 2; 
        }
        
        h1 { 
            margin: 5px 0 15px 0; 
            font-family: 'Georgia', serif; 
            letter-spacing: 1px; 
            font-size: 2rem; 
            cursor: pointer; 
            color: #ffd700; 
            text-shadow: 0 2px 4px rgba(0,0,0,0.8);
        }
        
        .control-group { margin-bottom: 10px; }

        /* Languages & More Button Inline */
        .lang-row {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 8px;
        }

        /* Styled Radios */
        .radio-btn-group input[type="radio"] { display: none; }
        .radio-btn-group label, .toggle-btn {
            background: rgba(0, 0, 0, 0.4); 
            padding: 10px 16px; 
            border-radius: 25px;
            cursor: pointer;
            border: 1px solid rgba(255,255,255,0.3);
            transition: 0.2s;
            font-size: 0.9rem;
            color: white;
            white-space: nowrap;
            display: inline-block;
        }

        .radio-btn-group input[type="radio"]:checked + label {
            background: #c0392b; 
            border-color: gold; 
            font-weight: bold; 
            box-shadow: 0 0 10px rgba(192, 57, 43, 0.6);
        }

        /* More Button Styling to match radios */
        .toggle-btn {
            border: 1px dashed rgba(255,255,255,0.5);
            font-size: 0.9rem;
            padding: 10px 16px;
        }

        #extra-languages {
            display: none; 
            justify-content: center;
            gap: 8px; 
            flex-wrap: wrap;
            margin-top: 10px; 
            width: 100%;
            animation: fadeIn 0.3s;
        }

        #personalize-container { display: none; margin-top: 10px; background: rgba(0,0,0,0.5); padding: 12px; border-radius: 10px; }
        .input-row { display: flex; gap: 8px; justify-content: center; }
        #personalize-prompt { padding: 10px; border-radius: 5px; border: none; width: 60%; font-size: 1rem;}
        #generate-btn { padding: 10px 18px; background: gold; border: none; border-radius: 5px; color: #8b0000; font-weight: bold; cursor: pointer; font-size: 1rem;}

        /* --- Game Area (Bigger Blocks) --- */
        .game-area { 
            flex-grow: 1; 
            display: flex; 
            flex-direction: column; 
            padding: 20px;
            gap: 20px; /* Space between cards */
            justify-content: center;
        }

        .card {
            flex: 1; 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center;
            padding: 30px 20px; 
            text-align: center; 
            cursor: pointer; 
            position: relative; 
            overflow: hidden; 
            border-radius: 20px; /* Rounded corners */
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
            transition: transform 0.1s;
            /* BIGGER BLOCKS: Ensure they take up height */
            min-height: 280px; 
        }

        .card:active { transform: scale(0.98); }
        
        .truth-section { 
            background: var(--truth-color); 
            color: var(--truth-text); 
            border: 2px solid #ddd;
        }
        .dare-section { 
            background: var(--dare-color); 
            color: var(--dare-text); 
            border: 2px solid #5a0000;
        }

        .card-icon { font-size: 3.5rem; margin-bottom: 10px; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2)); }
        .card-title { font-size: 2.5rem; font-weight: 800; text-transform: uppercase; margin: 0; letter-spacing: 2px;}
        
        .prompt-content { margin-top: 10px; display: flex; flex-direction: column; align-items: center; width: 100%; flex-grow: 1; justify-content: center; }
        .prompt-text { font-size: 1.6rem; font-weight: 600; margin-bottom: 10px; max-width: 95%; line-height: 1.3; }
        .dare-visual { font-size: 5rem; animation: popIn 0.5s; display: none;}
        
        .click-instruction { 
            margin-top: auto; 
            font-size: 0.85rem; 
            opacity: 0.7; 
            text-transform: uppercase; 
            letter-spacing: 1px; 
            animation: pulse 2s infinite; 
        }

        /* --- Animations & Utilities --- */
        @keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }
        @keyframes popIn { from { transform: scale(0); } to { transform: scale(1); } }
        .fade-in { animation: fadeIn 0.4s forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Fixed decorations */
        .xmas-tree {
            position: fixed; bottom: 20px; right: 20px; font-size: 4rem; z-index: 5;
            pointer-events: none; filter: drop-shadow(0 0 10px gold); opacity: 0.9;
        }

        /* --- Mobile Optimization --- */
        @media (max-width: 600px) {
            h1 { font-size: 1.8rem; margin-bottom: 10px; }
            .radio-btn-group label, .toggle-btn { padding: 8px 12px; font-size: 0.85rem; }
            .game-area { padding: 10px; gap: 15px; }
            
            /* Big blocks on mobile */
            .card { min-height: 220px; padding: 20px; }
            .card-title { font-size: 2rem; }
            .prompt-text { font-size: 1.3rem; }
            .card-icon { font-size: 2.5rem; }
        }
    </style>
</head>
<body>

    <div class="snow-container" id="snow-bg"></div>
    <div class="xmas-tree">ğŸ„</div>

    <div class="app-container">
        
        <header class="top-header-container">
            <div class="settings-panel">
                <h1 onclick="location.reload()" title="Tap to Reset">ğŸ„ Truth or Dare ğŸ</h1>

                <div class="control-group">
                    <div class="lang-row radio-btn-group">
                        <input type="radio" name="lang" id="en" value="en" checked onclick="setLang('en')">
                        <label for="en">ğŸ‡ºğŸ‡¸ EN</label>
                        
                        <input type="radio" name="lang" id="fr" value="fr" onclick="setLang('fr')">
                        <label for="fr">ğŸ‡«ğŸ‡· FR</label>
                        
                        <input type="radio" name="lang" id="zh" value="zh" onclick="setLang('zh')">
                        <label for="zh">ğŸ‡¨ğŸ‡³ ZH</label>
                        
                        <input type="radio" name="lang" id="es" value="es" onclick="setLang('es')">
                        <label for="es">ğŸ‡ªğŸ‡¸ ES</label>

                        <button class="toggle-btn" onclick="toggleExtraLangs()">+ More</button>
                    </div>

                    <div class="radio-btn-group" id="extra-languages">
                        <input type="radio" name="lang" id="it" value="it" onclick="setLang('it')">
                        <label for="it">ğŸ‡®ğŸ‡¹ IT</label>
                        <input type="radio" name="lang" id="de" value="de" onclick="setLang('de')">
                        <label for="de">ğŸ‡©ğŸ‡ª DE</label>
                        <input type="radio" name="lang" id="ja" value="ja" onclick="setLang('ja')">
                        <label for="ja">ğŸ‡¯ğŸ‡µ JA</label>
                        <input type="radio" name="lang" id="da" value="da" onclick="setLang('da')">
                        <label for="da">ğŸ‡©ğŸ‡° DA</label>
                    </div>
                </div>

                <div class="control-group radio-btn-group" style="display: flex; justify-content: center; gap: 8px; flex-wrap: wrap;">
                    <input type="radio" name="scen" id="christmas" value="christmas" checked onclick="setScenario('christmas')">
                    <label for="christmas">ğŸ… Xmas</label>
                    <input type="radio" name="scen" id="campus" value="campus" onclick="setScenario('campus')">
                    <label for="campus">ğŸ« Campus</label>
                    <input type="radio" name="scen" id="friends" value="friends" onclick="setScenario('friends')">
                    <label for="friends">ğŸ» Friends</label>
                    <input type="radio" name="scen" id="family" value="family" onclick="setScenario('family')">
                    <label for="family">ğŸ  Family</label>
                    <input type="radio" name="scen" id="personalize" value="personalize" onclick="setScenario('personalize')">
                    <label for="personalize" style="border-color: gold;">âœ¨ Personalize</label>
                </div>

                <div id="personalize-container">
                    <div class="input-row">
                        <input type="text" id="personalize-prompt" placeholder="Theme (e.g. Party)...">
                        <button id="generate-btn" onclick="generatePersonalizedDeck()">Go</button>
                    </div>
                    <div id="gen-status" style="margin-top:5px; font-size: 0.8rem; color:#ddd;"></div>
                </div>
            </div>
        </header>

        <div class="game-area">
            <div class="card truth-section" onclick="playTurn(this, 'truth')">
                <div class="card-icon">ğŸ˜‡</div>
                <h2 class="card-title">Truth</h2>
                <div class="prompt-content">
                    <div class="prompt-text" id="truth-text">Tap for Truth</div>
                </div>
                <div class="click-instruction">Tap card to play</div>
            </div>

            <div class="card dare-section" onclick="playTurn(this, 'dare')">
                <div class="card-icon">ğŸ˜ˆ</div>
                <h2 class="card-title">Dare</h2>
                <div class="prompt-content">
                    <div class="prompt-text" id="dare-text">Tap for Dare</div>
                    <div id="dare-visual" class="dare-visual"></div>
                </div>
                <div class="click-instruction">Tap card to play</div>
            </div>
        </div>
    </div>

    <script>
        // --- DATA & LOGIC ---
        // (Keeping logic same, updated visuals)
        const db = {
            en: {
                campus: { 
                    truth: ["Who is your biggest crush on campus?", "What's your lowest grade ever?", "Fallen asleep in a lecture?", "Cheated on an exam?", "Weirdest professor?", "Skipped a whole day?", "Worst cafeteria meal?", "Who do you avoid here?", "Walked into wrong class?", "Most embarrassing school moment?", "Hooked up in a dorm?", "Who studies least?", "Failed a class?"], 
                    dare: [{t:"Yell 'I LOVE EXAMS' out the window.",i:"ğŸ“¢"}, {t:"Interpretive dance in hallway.",i:"ğŸ’ƒ"}, {t:"Text crush a wave emoji.",i:"ğŸ‘‹"}, {t:"Ask stranger for pencil.",i:"âœï¸"}, {t:"Sit on floor next round.",i:"ğŸ§˜"}, {t:"British accent 2 turns.",i:"ğŸ‡¬ğŸ‡§"}, {t:"Selfie to professor.",i:"ğŸ¤³"}, {t:"Book on head 1 min.",i:"ğŸ“š"}, {t:"Act like monkey 30s.",i:"ğŸ’"}, {t:"Draw on hand.",i:"âœï¸"}, {t:"Imitate favorite teacher.",i:"ğŸ‘¨â€ğŸ«"}, {t:"Walk backwards.",i:"ğŸ”™"}, {t:"Sing anthem loud.",i:"ğŸ¤"}, {t:"Show last photo.",i:"ğŸ“·"}, {t:"Call mom: 'I failed'.",i:"ğŸ“"}] 
                },
                family: { 
                    truth: ["Who is the favorite child?", "Secret kept from mom?", "Best gift ever?", "Blamed sibling for your fault?", "Lied about where you went?", "Snuck out?", "Relative you dislike?", "Lie told to dad?", "Read sibling's diary?", "Like grandma's cooking?", "Worst trouble ever?", "Faked sick?", "Worst cousin?", "Hated tradition?", "Stole money from parents?"], 
                    dare: [{t:"Hug sibling 1 min.",i:"ğŸ«‚"}, {t:"Opera Christmas song.",i:"ğŸ¶"}, {t:"Show last photo.",i:"ğŸ“±"}, {t:"Do dishes tonight.",i:"ğŸ½ï¸"}, {t:"Massage mom's shoulders.",i:"ğŸ’†"}, {t:"Act like baby 1 min.",i:"ğŸ‘¶"}, {t:"Dad picks profile pic.",i:"ğŸ–¼ï¸"}, {t:"Slow dance with sibling.",i:"ğŸ’ƒ"}, {t:"Eat raw garlic.",i:"ğŸ§„"}, {t:"Tell parent 'I love you'.",i:"â¤ï¸"}, {t:"Crab walk.",i:"ğŸ¦€"}, {t:"Funny face.",i:"ğŸ¤ª"}, {t:"Smell own socks.",i:"ğŸ§¦"}, {t:"Get tickled 10s.",i:"ğŸ¤£"}, {t:"Whisper only.",i:"ğŸ¤«"}] 
                },
                friends: { 
                    truth: ["Trust least here?", "Biggest regret?", "Lied to cancel?", "Stalked ex?", "Best dressed here?", "Kissed friend's ex?", "Embarrassing habit?", "Funniest person?", "Peed in pool?", "Grossest thing done?", "Worst driver?", "Stole something?", "Date who here?", "Irrational fear?", "Last cried?"], 
                    dare: [{t:"Swap shirts left.",i:"ğŸ‘•"}, {t:"Text group 'I love you'.",i:"ğŸ’¬"}, {t:"10 pushups.",i:"ğŸ’ª"}, {t:"Fake accent 2 turns.",i:"ğŸ—£ï¸"}, {t:"Let someone style hair.",i:"ğŸ’‡"}, {t:"Spoon of hot sauce.",i:"ğŸŒ¶ï¸"}, {t:"Post ugly selfie.",i:"ğŸ“¸"}, {t:"Bark at next entry.",i:"ğŸ¶"}, {t:"Drink mystery mix.",i:"ğŸ¥¤"}, {t:"Spin 10x walk straight.",i:"ğŸ˜µ"}, {t:"Draw on forehead.",i:"ğŸ–ï¸"}, {t:"Dance with broom.",i:"ğŸ§¹"}, {t:"Imitate someone.",i:"ğŸ¤¡"}, {t:"Hold ice cube.",i:"ğŸ§Š"}, {t:"Read last text.",i:"ğŸ“±"}] 
                },
                christmas: { 
                    truth: ["Best gift ever?", "Re-gifted?", "Like fruitcake?", "Peeked at gifts?", "Worst cook?", "Stopped believing in Santa?", "Knocked over tree?", "Best Xmas movie?", "Forgot gift?", "Drinks too much?", "Best memory?", "Kiss under mistletoe?", "Real wish?", "Like eggnog?", "Broke ornament?"], 
                    dare: [{t:"Act like reindeer.",i:"ğŸ¦Œ"}, {t:"Spoon of cinnamon.",i:"ğŸ¥„"}, {t:"Wear bow on head.",i:"ğŸ€"}, {t:"Santa impression.",i:"ğŸ…"}, {t:"Wrap in tinsel.",i:"ğŸ„"}, {t:"Opera Jingle Bells.",i:"ğŸ¤"}, {t:"Sit on lap, tell wish.",i:"ğŸª‘"}, {t:"Act like elf.",i:"ğŸ§"}, {t:"Pillow under shirt.",i:"ğŸ¤°"}, {t:"Paper snowflake.",i:"â„ï¸"}, {t:"Kiss cheek right.",i:"ğŸ’‹"}, {t:"Cookie no hands.",i:"ğŸª"}, {t:"Frozen snowman.",i:"â›„"}, {t:"Melting candle.",i:"ğŸ•¯ï¸"}, {t:"Mime giant gift.",i:"ğŸ"}] 
                }
            },
            fr: {
                campus: { truth: ["Ton crush sur le campus ?", "Pire note ?", "Dormi en cours ?", "TrichÃ© exam ?", "Prof bizarre ?", "SÃ©chÃ© journÃ©e ?", "Pire repas RU ?", "Qui Ã©viter ?", "Mauvaise salle ?", "Moment gÃªnant ?", "Dormi chambre autre ?", "Travaille moins ?", "RatÃ© matiÃ¨re ?"], dare: [{t:"Crie 'J'ADORE EXAMS'.",i:"ğŸ“¢"}, {t:"Danse couloir.",i:"ğŸ’ƒ"}, {t:"Emoji ğŸ‘‹ au crush.",i:"ğŸ‘‹"}, {t:"Stylo inconnu.",i:"âœï¸"}, {t:"Assieds-toi sol.",i:"ğŸ§˜"}, {t:"Accent anglais.",i:"ğŸ‡¬ğŸ‡§"}, {t:"Selfie prof.",i:"ğŸ¤³"}, {t:"Livre tÃªte 1 min.",i:"ğŸ“š"}, {t:"Singe 30s.",i:"ğŸ’"}, {t:"Dessin main.",i:"âœï¸"}, {t:"Imite prof.",i:"ğŸ‘¨â€ğŸ«"}, {t:"Marche reculons.",i:"ğŸ”™"}, {t:"Hymne national.",i:"ğŸ¤"}, {t:"DerniÃ¨re photo.",i:"ğŸ“·"}, {t:"Appelle mÃ¨re 'ratÃ©'.",i:"ğŸ“"}] },
                family: { truth: ["Enfant prÃ©fÃ©rÃ© ?", "Secret mÃ¨re ?", "Beau cadeau ?", "AccusÃ© frÃ¨re ?", "Menti sortie ?", "Fait le mur ?", "Membre Ã©nervant ?", "Mensonge pÃ¨re ?", "Lu journal ?", "Cuisine mamie ?", "Pire bÃªtise ?", "Faux malade ?", "Pire cousin ?", "Tradition dÃ©testÃ©e ?", "VolÃ© argent ?"], dare: [{t:"CÃ¢lin frÃ¨re 1 min.",i:"ğŸ«‚"}, {t:"Chant NoÃ«l opÃ©ra.",i:"ğŸ¶"}, {t:"DerniÃ¨re photo.",i:"ğŸ“±"}, {t:"Vaisselle ce soir.",i:"ğŸ½ï¸"}, {t:"Massage mÃ¨re.",i:"ğŸ’†"}, {t:"BÃ©bÃ© 1 min.",i:"ğŸ‘¶"}, {t:"PÃ¨re choisit photo.",i:"ğŸ–¼ï¸"}, {t:"Slow frÃ¨re/soeur.",i:"ğŸ’ƒ"}, {t:"Ail cru.",i:"ğŸ§„"}, {t:"Dis 'Je t'aime'.",i:"â¤ï¸"}, {t:"Marche crabe.",i:"ğŸ¦€"}, {t:"Grimace.",i:"ğŸ¤ª"}, {t:"Sens chaussettes.",i:"ğŸ§¦"}, {t:"Chatouilles 10s.",i:"ğŸ¤£"}, {t:"Chuchote.",i:"ğŸ¤«"}] },
                friends: { truth: ["Moins confiance ?", "Regret ?", "Menti annuler ?", "Stalk ex ?", "Mieux habillÃ© ?", "EmbrassÃ© ex ami ?", "Habitude gÃªnante ?", "Plus drÃ´le ?", "Pipi piscine ?", "DÃ©goÃ»tant ?", "Pire conducteur ?", "VolÃ© truc ?", "Date qui ?", "Peur bÃªte ?", "Derniers pleurs ?"], dare: [{t:"Ã‰change t-shirt.",i:"ğŸ‘•"}, {t:"Msg 'Je vous aime'.",i:"ğŸ’¬"}, {t:"10 pompes.",i:"ğŸ’ª"}, {t:"Accent Ã©tranger.",i:"ğŸ—£ï¸"}, {t:"Coiffure libre.",i:"ğŸ’‡"}, {t:"Sauce piquante.",i:"ğŸŒ¶ï¸"}, {t:"Selfie moche.",i:"ğŸ“¸"}, {t:"Aboie chien.",i:"ğŸ¶"}, {t:"Bois mystÃ¨re.",i:"ğŸ¥¤"}, {t:"Tourne 10x.",i:"ğŸ˜µ"}, {t:"Dessin front.",i:"ğŸ–ï¸"}, {t:"Danse balai.",i:"ğŸ§¹"}, {t:"Imite qqn.",i:"ğŸ¤¡"}, {t:"GlaÃ§on main.",i:"ğŸ§Š"}, {t:"Lis dernier SMS.",i:"ğŸ“±"}] },
                christmas: { truth: ["Cadeau inoubliable ?", "Cadeau recyclÃ© ?", "BÃ»che ?", "Cadeaux avance ?", "Pire cuisinier ?", "Croit plus NoÃ«l ?", "Sapin tombÃ© ?", "Film NoÃ«l ?", "Oubli cadeau ?", "Boit trop ?", "Souvenir ?", "Bisou gui ?", "Vrai voeu ?", "Lait poule ?", "Boule cassÃ©e ?"], dare: [{t:"Renne 1 min.",i:"ğŸ¦Œ"}, {t:"Cannelle.",i:"ğŸ¥„"}, {t:"Noeud tÃªte.",i:"ğŸ€"}, {t:"Imite PÃ¨re NoÃ«l.",i:"ğŸ…"}, {t:"Guirlandes.",i:"ğŸ„"}, {t:"Chante opÃ©ra.",i:"ğŸ¤"}, {t:"Genoux voeu.",i:"ğŸª‘"}, {t:"Elfe jouets.",i:"ğŸ§"}, {t:"Ventre coussin.",i:"ğŸ¤°"}, {t:"Flocon papier.",i:"â„ï¸"}, {t:"Bisou joue.",i:"ğŸ’‹"}, {t:"GÃ¢teau sans mains.",i:"ğŸª"}, {t:"Bonhomme neige.",i:"â›„"}, {t:"Bougie fond.",i:"ğŸ•¯ï¸"}, {t:"Cadeau invisible.",i:"ğŸ"}] }
            },
            zh: {
                campus: { truth: ["æœ€æš—æ‹è°ï¼Ÿ", "æœ€ä½åˆ†ï¼Ÿ", "è¯¾ä¸Šç¡è§‰ï¼Ÿ", "è€ƒè¯•ä½œå¼Šï¼Ÿ", "å¥‡æ€ªæ•™æˆï¼Ÿ", "ç¿˜è¯¾ä¸€å¤©ï¼Ÿ", "æœ€éš¾åƒé£Ÿå ‚ï¼Ÿ", "é¿å¼€è°ï¼Ÿ", "èµ°é”™æ•™å®¤ï¼Ÿ", "å°´å°¬æ—¶åˆ»ï¼Ÿ", "å®¿èˆè¿‡å¤œï¼Ÿ", "ä¸çˆ±å­¦ä¹ ï¼Ÿ", "æŒ‚ç§‘ï¼Ÿ"], dare: [{t:"å–Šâ€œçˆ±è€ƒè¯•â€",i:"ğŸ“¢"}, {t:"èµ°å»Šè·³èˆ",i:"ğŸ’ƒ"}, {t:"å‘è¡¨æƒ…ç»™æš—æ‹",i:"ğŸ‘‹"}, {t:"å€Ÿç¬”",i:"âœï¸"}, {t:"ååœ°æ¿",i:"ğŸ§˜"}, {t:"å¥‡æ€ªå£éŸ³",i:"ğŸ‡¬ğŸ‡§"}, {t:"è‡ªæ‹ç»™æ•™æˆ",i:"ğŸ¤³"}, {t:"å¤´é¡¶ä¹¦",i:"ğŸ“š"}, {t:"æ‰®çŒ´å­",i:"ğŸ’"}, {t:"æ‰‹ä¸Šç”»ç”»",i:"âœï¸"}, {t:"æ¨¡ä»¿è€å¸ˆ",i:"ğŸ‘¨â€ğŸ«"}, {t:"å€’ç€èµ°",i:"ğŸ”™"}, {t:"å”±å›½æ­Œ",i:"ğŸ¤"}, {t:"æœ€åç…§ç‰‡",i:"ğŸ“·"}, {t:"ç”µè¯â€œä¸åŠæ ¼â€",i:"ğŸ“"}] },
                family: { truth: ["æœ€çˆ±å­©å­ï¼Ÿ", "ç’å¦ˆå¦ˆï¼Ÿ", "æœ€å¥½ç¤¼ç‰©ï¼Ÿ", "æ¨å¸è´£ä»»ï¼Ÿ", "æ’’è°å»å¤„ï¼Ÿ", "æºœå‡ºé—¨ï¼Ÿ", "çƒ¦äº²æˆšï¼Ÿ", "æ’’è°çˆ¸çˆ¸ï¼Ÿ", "çœ‹æ—¥è®°ï¼Ÿ", "å¥¶å¥¶åšèœï¼Ÿ", "å¤§éº»çƒ¦ï¼Ÿ", "è£…ç—…ï¼Ÿ", "è®¨åŒè¡¨äº²ï¼Ÿ", "è®¨åŒä¼ ç»Ÿï¼Ÿ", "å·é’±ï¼Ÿ"], dare: [{t:"æ‹¥æŠ±ä¸€åˆ†é’Ÿ",i:"ğŸ«‚"}, {t:"æ­Œå‰§å”±åœ£è¯",i:"ğŸ¶"}, {t:"æœ€åç…§ç‰‡",i:"ğŸ“±"}, {t:"æ´—ç¢—",i:"ğŸ½ï¸"}, {t:"æŒ‰æ‘©è‚©è†€",i:"ğŸ’†"}, {t:"æ‰®å©´å„¿",i:"ğŸ‘¶"}, {t:"çˆ¸é€‰å¤´åƒ",i:"ğŸ–¼ï¸"}, {t:"è·³æ…¢èˆ",i:"ğŸ’ƒ"}, {t:"åƒè’œ",i:"ğŸ§„"}, {t:"è¯´çˆ±çˆ¶æ¯",i:"â¤ï¸"}, {t:"èƒèŸ¹èµ°",i:"ğŸ¦€"}, {t:"åšé¬¼è„¸",i:"ğŸ¤ª"}, {t:"é—»è¢œå­",i:"ğŸ§¦"}, {t:"æŒ ç—’ç—’",i:"ğŸ¤£"}, {t:"è€³è¯­",i:"ğŸ¤«"}] },
                friends: { truth: ["ä¸ä¿¡ä»»è°ï¼Ÿ", "é—æ†¾ï¼Ÿ", "æ’’è°å–æ¶ˆï¼Ÿ", "è§†å¥¸å‰ä»»ï¼Ÿ", "æœ€å¥½çœ‹ï¼Ÿ", "äº²æœ‹å‹å‰ä»»ï¼Ÿ", "å°´å°¬ä¹ æƒ¯ï¼Ÿ", "æœ€æç¬‘ï¼Ÿ", "æ³³æ± å°¿å°¿ï¼Ÿ", "æ¶å¿ƒäº‹ï¼Ÿ", "è½¦æŠ€å·®ï¼Ÿ", "å·ä¸œè¥¿ï¼Ÿ", "çº¦ä¼šè°ï¼Ÿ", "ææƒ§ï¼Ÿ", "å“­ï¼Ÿ"], dare: [{t:"æ¢Tæ¤",i:"ğŸ‘•"}, {t:"å‘â€œçˆ±ä½ ä»¬â€",i:"ğŸ’¬"}, {t:"ä¿¯å§æ’‘",i:"ğŸ’ª"}, {t:"å¥‡æ€ªå£éŸ³",i:"ğŸ—£ï¸"}, {t:"è®¾è®¡å‘å‹",i:"ğŸ’‡"}, {t:"è¾£é…±",i:"ğŸŒ¶ï¸"}, {t:"å‘ä¸‘ç…§",i:"ğŸ“¸"}, {t:"å­¦ç‹—å«",i:"ğŸ¶"}, {t:"å–é¥®æ–™",i:"ğŸ¥¤"}, {t:"è½¬åœˆèµ°ç›´çº¿",i:"ğŸ˜µ"}, {t:"é¢å¤´ç”»ç”»",i:"ğŸ–ï¸"}, {t:"æ‰«æŠŠèˆ",i:"ğŸ§¹"}, {t:"æ¨¡ä»¿äºº",i:"ğŸ¤¡"}, {t:"æ¡å†°å—",i:"ğŸ§Š"}, {t:"è¯»çŸ­ä¿¡",i:"ğŸ“±"}] },
                christmas: { truth: ["æœ€å¥½ç¤¼ç‰©ï¼Ÿ", "è½¬é€ï¼Ÿ", "æ°´æœè›‹ç³•ï¼Ÿ", "å·çœ‹ï¼Ÿ", "åšé¥­éš¾åƒï¼Ÿ", "ä¸ä¿¡åœ£è¯è€äººï¼Ÿ", "æ’å€’æ ‘ï¼Ÿ", "ç”µå½±ï¼Ÿ", "å¿˜ä¹°ç¤¼ç‰©ï¼Ÿ", "å–å¤šï¼Ÿ", "è®°å¿†ï¼Ÿ", "äº²å»ï¼Ÿ", "æ„¿æœ›ï¼Ÿ", "è›‹é…’ï¼Ÿ", "æ‰“ç¢è£…é¥°ï¼Ÿ"], dare: [{t:"é©¯é¹¿",i:"ğŸ¦Œ"}, {t:"åƒè‚‰æ¡‚",i:"ğŸ¥„"}, {t:"æˆ´èŠ±ç»“",i:"ğŸ€"}, {t:"åœ£è¯è€äºº",i:"ğŸ…"}, {t:"å½©å¸¦åŒ…",i:"ğŸ„"}, {t:"å”±é“ƒå„¿å“",i:"ğŸ¤"}, {t:"åè…¿è®¸æ„¿",i:"ğŸª‘"}, {t:"æ‰®ç²¾çµ",i:"ğŸ§"}, {t:"è£…å¤§è‚šå­",i:"ğŸ¤°"}, {t:"å‰ªé›ªèŠ±",i:"â„ï¸"}, {t:"äº²è„¸é¢Š",i:"ğŸ’‹"}, {t:"åƒé¥¼å¹²",i:"ğŸª"}, {t:"é›ªäºº",i:"â›„"}, {t:"èœ¡çƒ›",i:"ğŸ•¯ï¸"}, {t:"å¼€ç¤¼ç‰©",i:"ğŸ"}] }
            },
            es: {
                campus: { truth: ["Â¿Amor platÃ³nico?", "Â¿Peor nota?", "Â¿Dormido en clase?", "Â¿Copiado examen?", "Â¿Profe raro?", "Â¿Faltado dÃ­a?", "Â¿Peor comida?", "Â¿A quiÃ©n evitas?", "Â¿Clase equivocada?", "Â¿Momento vergonzoso?", "Â¿Dormir acompaÃ±ado?", "Â¿Estudia menos?", "Â¿Suspendido?"], dare: [{t:"Grita 'AMO EXÃMENES'.",i:"ğŸ“¢"}, {t:"Baile pasillo.",i:"ğŸ’ƒ"}, {t:"Emoji ğŸ‘‹ crush.",i:"ğŸ‘‹"}, {t:"Pide lÃ¡piz.",i:"âœï¸"}, {t:"Sienta suelo.",i:"ğŸ§˜"}, {t:"Acento raro.",i:"ğŸ‡¬ğŸ‡§"}, {t:"Selfie profe.",i:"ğŸ¤³"}, {t:"Libro cabeza.",i:"ğŸ“š"}, {t:"Mono 30s.",i:"ğŸ’"}, {t:"Dibuja mano.",i:"âœï¸"}, {t:"Imita profe.",i:"ğŸ‘¨â€ğŸ«"}, {t:"Camina atrÃ¡s.",i:"ğŸ”™"}, {t:"Himno alto.",i:"ğŸ¤"}, {t:"Ãšltima foto.",i:"ğŸ“·"}, {t:"Llama mamÃ¡ 'suspenso'.",i:"ğŸ“"}] },
                family: { truth: ["Â¿Hijo favorito?", "Â¿Secreto mamÃ¡?", "Â¿Mejor regalo?", "Â¿Culpado hermano?", "Â¿Mentido lugar?", "Â¿Escapado?", "Â¿Familiar molesto?", "Â¿Mentira papÃ¡?", "Â¿LeÃ­do diario?", "Â¿Comida abuela?", "Â¿Mayor lÃ­o?", "Â¿Fingido enfermo?", "Â¿Peor primo?", "Â¿TradiciÃ³n odiada?", "Â¿Robado dinero?"], dare: [{t:"Abrazo 1 min.",i:"ğŸ«‚"}, {t:"Canta Ã³pera.",i:"ğŸ¶"}, {t:"Ãšltima foto.",i:"ğŸ“±"}, {t:"Lava platos.",i:"ğŸ½ï¸"}, {t:"Masaje mamÃ¡.",i:"ğŸ’†"}, {t:"BebÃ© 1 min.",i:"ğŸ‘¶"}, {t:"PapÃ¡ elige foto.",i:"ğŸ–¼ï¸"}, {t:"Baila lento.",i:"ğŸ’ƒ"}, {t:"Ajo crudo.",i:"ğŸ§„"}, {t:"Di 'Te quiero'.",i:"â¤ï¸"}, {t:"Cangrejo.",i:"ğŸ¦€"}, {t:"Cara graciosa.",i:"ğŸ¤ª"}, {t:"Huele calcetines.",i:"ğŸ§¦"}, {t:"Cosquillas 10s.",i:"ğŸ¤£"}, {t:"Susurra.",i:"ğŸ¤«"}] },
                friends: { truth: ["Â¿Menos confianza?", "Â¿Arrepentimiento?", "Â¿Mentido cancelar?", "Â¿Stalkeado ex?", "Â¿Mejor vestido?", "Â¿Besado ex amigo?", "Â¿HÃ¡bito raro?", "Â¿MÃ¡s divertido?", "Â¿Pis piscina?", "Â¿Asqueroso?", "Â¿Peor conductor?", "Â¿Robado algo?", "Â¿Cita quiÃ©n?", "Â¿Miedo?", "Â¿Llorado?"], dare: [{t:"Cambia camiseta.",i:"ğŸ‘•"}, {t:"Mensaje 'Os quiero'.",i:"ğŸ’¬"}, {t:"10 flexiones.",i:"ğŸ’ª"}, {t:"Acento raro.",i:"ğŸ—£ï¸"}, {t:"Peinado libre.",i:"ğŸ’‡"}, {t:"Picante.",i:"ğŸŒ¶ï¸"}, {t:"Selfie feo.",i:"ğŸ“¸"}, {t:"Ladra.",i:"ğŸ¶"}, {t:"Bebida misterio.",i:"ğŸ¥¤"}, {t:"Gira 10 veces.",i:"ğŸ˜µ"}, {t:"Pinta frente.",i:"ğŸ–ï¸"}, {t:"Baila escoba.",i:"ğŸ§¹"}, {t:"Imita alguien.",i:"ğŸ¤¡"}, {t:"Hielo mano.",i:"ğŸ§Š"}, {t:"Lee mensaje.",i:"ğŸ“±"}] },
                christmas: { truth: ["Â¿Mejor regalo?", "Â¿Regalado regalo?", "Â¿Pastel frutas?", "Â¿Buscado regalos?", "Â¿Peor cocinero?", "Â¿Creer Santa?", "Â¿Ãrbol caÃ­do?", "Â¿Peli Navidad?", "Â¿Olvidado regalo?", "Â¿Bebe mucho?", "Â¿Recuerdo?", "Â¿Beso muÃ©rdago?", "Â¿Deseo real?", "Â¿Ponche huevo?", "Â¿Adorno roto?"], dare: [{t:"Reno 1 min.",i:"ğŸ¦Œ"}, {t:"Canela.",i:"ğŸ¥„"}, {t:"Lazo cabeza.",i:"ğŸ€"}, {t:"Imita Santa.",i:"ğŸ…"}, {t:"Guirnaldas.",i:"ğŸ„"}, {t:"Canta Ã³pera.",i:"ğŸ¤"}, {t:"Sentarse rodilla.",i:"ğŸª‘"}, {t:"Elfo juguetes.",i:"ğŸ§"}, {t:"Almohada barriga.",i:"ğŸ¤°"}, {t:"Copo papel.",i:"â„ï¸"}, {t:"Beso mejilla.",i:"ğŸ’‹"}, {t:"Galleta sin manos.",i:"ğŸª"}, {t:"MuÃ±eco nieve.",i:"â›„"}, {t:"Vela derretida.",i:"ğŸ•¯ï¸"}, {t:"Regalo invisible.",i:"ğŸ"}] }
            }
        };

        // Initialize Variables
        let currentLang = 'en';
        let currentScenario = 'christmas';
        let generatedDeck = { truth: [], dare: [] };
        let seenIndices = { truth: new Set(), dare: new Set() };

        // Snow Generator
        function createSnow() {
            const snowContainer = document.getElementById('snow-bg');
            // Create 50 dotty snowflakes
            for (let i = 0; i < 50; i++) {
                const snowflake = document.createElement('div');
                snowflake.className = 'snowflake';
                // Random position & size
                snowflake.style.left = Math.random() * 100 + 'vw';
                const size = Math.random() * 5 + 3 + 'px'; // 3px to 8px dots
                snowflake.style.width = size;
                snowflake.style.height = size;
                // Random animation speed
                snowflake.style.animationDuration = (Math.random() * 5 + 3) + 's';
                snowflake.style.animationDelay = Math.random() * 5 + 's';
                snowContainer.appendChild(snowflake);
            }
        }

        function resetTracker() {
            seenIndices = { truth: new Set(), dare: new Set() };
        }

        function setLang(lang) {
            currentLang = lang;
            resetTracker(); 
            updateUIText();
        }

        function toggleExtraLangs() {
            const extraDiv = document.getElementById('extra-languages');
            const btn = document.querySelector('.toggle-btn');
            if (extraDiv.style.display === 'flex') {
                extraDiv.style.display = 'none'; btn.innerText = "+ More";
            } else {
                extraDiv.style.display = 'flex'; btn.innerText = "- Less";
            }
        }

        function setScenario(scen) {
            currentScenario = scen;
            resetTracker(); 
            const inputContainer = document.getElementById('personalize-container');
            inputContainer.style.display = (scen === 'personalize') ? 'block' : 'none';
        }

        function generatePersonalizedDeck() {
            const input = document.getElementById('personalize-prompt').value.toLowerCase();
            const status = document.getElementById('gen-status');
            
            if(!input) {
                status.innerText = "Type a theme!";
                return;
            }
            status.innerText = "Generating...";
            setTimeout(() => {
                let mixTruth = [];
                let mixDare = [];
                const src = db.en; 
                // Simple keyword matching for demo
                if(input.includes("student") || input.includes("school")) { mixTruth.push(...src.campus.truth); mixDare.push(...src.campus.dare); }
                if(input.includes("party") || input.includes("drink")) { mixTruth.push(...src.friends.truth); mixDare.push(...src.friends.dare); }
                if(input.includes("family")) { mixTruth.push(...src.family.truth); mixDare.push(...src.family.dare); }
                if(input.includes("xmas") || input.includes("christmas")) { mixTruth.push(...src.christmas.truth); mixDare.push(...src.christmas.dare); }
                if(mixTruth.length === 0) { mixTruth.push(...src.friends.truth); mixDare.push(...src.friends.dare); }

                generatedDeck = { truth: mixTruth, dare: mixDare };
                resetTracker(); 
                status.innerText = "Deck Ready!";
                status.style.color = "#2ecc71";
            }, 500);
        }

        function updateUIText() {
            const uiText = {
                en: { truth: "Truth", dare: "Dare", click: "Tap card" },
                fr: { truth: "VÃ©ritÃ©", dare: "Action", click: "Appuyez" },
                zh: { truth: "çœŸå¿ƒè¯", dare: "å¤§å†’é™©", click: "ç‚¹å‡»" },
                es: { truth: "Verdad", dare: "Reto", click: "Toca" },
                it: { truth: "VeritÃ ", dare: "Obbligo", click: "Clicca" },
                de: { truth: "Wahrheit", dare: "Pflicht", click: "Klicken" },
                ja: { truth: "çœŸå®Ÿ", dare: "æŒ‘æˆ¦", click: "ã‚¯ãƒªãƒƒã‚¯" },
                da: { truth: "Sandhed", dare: "Konsekvens", click: "Klik" }
            };
            const txt = uiText[currentLang] || uiText.en;
            document.querySelector('.truth-section .card-title').innerText = txt.truth;
            document.querySelector('.dare-section .card-title').innerText = txt.dare;
            document.querySelectorAll('.click-instruction').forEach(el => el.innerText = txt.click);
        }

        function playTurn(cardElement, type) {
            const textEl = document.getElementById(type + '-text');
            const visualEl = document.getElementById('dare-visual');
            textEl.classList.remove('fade-in');
            
            if(type === 'dare') visualEl.style.display = 'none';

            let itemList = [];
            if (currentScenario === 'personalize') {
                itemList = generatedDeck[type];
                if(itemList.length === 0) { textEl.innerText = "Generate deck first!"; return; }
            } else {
                const langData = db[currentLang] || db.en;
                // Fallback to EN if lang missing
                itemList = (langData && langData[currentScenario]) ? langData[currentScenario][type] : db.en[currentScenario][type];
            }

            let availableIndices = itemList.map((_, i) => i).filter(i => !seenIndices[type].has(i));
            if (availableIndices.length === 0) {
                textEl.innerHTML = "ğŸ„ Merry Xmas! ğŸ†";
                return;
            }

            const randomIndex = availableIndices[Math.floor(Math.random() * availableIndices.length)];
            seenIndices[type].add(randomIndex);
            const selectedItem = itemList[randomIndex];

            setTimeout(() => {
                if(type === 'truth') {
                    textEl.innerText = selectedItem;
                } else {
                    textEl.innerText = selectedItem.t;
                    if(selectedItem.i) {
                        visualEl.innerText = selectedItem.i;
                        visualEl.style.display = 'block';
                    }
                }
                textEl.classList.add('fade-in');
            }, 50);
        }

        // Initialize
        createSnow();
        updateUIText();
    </script>
</body>
</html>
